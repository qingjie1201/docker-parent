{"version":3,"sources":["webpack:///src/components/custom/baseAttachmentDialog.vue","webpack:///./src/components/custom/baseAttachmentDialog.vue?752b","webpack:///./src/components/custom/baseAttachmentDialog.vue","webpack:///./src/components/custom/baseAttachmentDialog.vue?551c","webpack:///./src/components/custom/baseAttachmentDialog.vue?de38"],"names":["baseAttachmentDialog","global","size","close","_afterDialogClose","_row","_bizKey","id","_fileAccept","getData","_this","this","FormData","file","attachmentId","attachmentName","attachmentPath","attachmentRev","attachmentSize","attachmentType","refreshData","btnId","_this2","then","_index","msg","callBack","PagedTable","pagedTable","dateColumn","custom_baseAttachmentDialog","render","_vm","_h","$createElement","_c","_self","attrs","visible","before-close","close-on-click-modal","append-to-body","slot","staticClass","_v","ref","targetURL","jsonStr","btnList","customTableTool","prop","label","scopedSlots","_u","key","fn","scope","_s","row","width","setFileSize","type","accept","fileAccept","on","change","selectedFile","click","onCancelClick","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","module","exports","push","i","version","sources","names","mappings","sourcesContent","sourceRoot","content","locals"],"mappings":"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","file":"static/js/10.070f726a6305c575492e.js","sourcesContent":["<!--\r\n  描述：附件对话框\r\n  开发人：桑杨\r\n  开发日期：2017年8月17日\r\n-->\r\n<template lang=\"pug\">\r\n  el-dialog(v-bind:visible=\"visible\" v-bind:before-close=\"close\"\r\n  v-bind:close-on-click-modal=\"false\"\r\n  v-bind:append-to-body=\"true\")\r\n    span(slot=\"title\")\r\n      i.iconfont.icon-attachment-column\r\n      | 附件管理\r\n    div.file-list\r\n      paged-table(ref=\"pagedTable\"\r\n      v-bind:targetURL=\"targetURL\"\r\n      v-bind:jsonStr=\"jsonStr\"\r\n      v-bind:btnList='btnList'\r\n      v-bind:customTableTool=\"customTableTool\")\r\n        template(slot=\"tableColumnSlot\")\r\n          el-table-column(prop=\"attachmentName\" label=\"名称\")\r\n            template(slot-scope=\"scope\")\r\n              div.attachment-name {{scope.row.attachmentName}}\r\n          el-table-column(label=\"大小\" width=\"100\")\r\n            template(slot-scope=\"scope\")\r\n              span {{setFileSize(scope.row.attachmentSize)}}\r\n          el-table-column(prop=\"attachmentType\" label=\"类型\" width=\"116\")\r\n          kalix-date-column(prop=\"creationDate\" label=\"上传日期\")\r\n          el-table-column(width=\"1\")\r\n    div.dialog-footer(slot=\"footer\")\r\n      el-button.upload\r\n        i.iconfont.icon-upload\r\n        | 上 传\r\n        input(ref=\"iptFile\" type=\"file\" v-on:change=\"selectedFile\" v-bind:accept=\"fileAccept\" )\r\n      el-button(type=\"primary\" v-on:click=\"onCancelClick\") 关 闭\r\n</template>\r\n<script type=\"text/ecmascript-6\">\r\n  import Message from 'common/message'\r\n  import EventBus from 'common/eventbus'\r\n  import {AttachmentURL} from 'config/global.toml'\r\n  import PagedTable from './pagedTable'\r\n  import DateColumn from 'views/oa/comp/dateColumn'\r\n  import prettyBytes from 'common/pretty-bytes'\r\n\r\n  const MAX_TABLE_HEIGHT = 450\r\n  export default {\r\n    data() {\r\n      return {\r\n        btnList: [\r\n          {\r\n            id: 'delete',\r\n            title: '删除',\r\n            isShow: true,\r\n            isPermission: true\r\n          },\r\n          {\r\n            id: 'download',\r\n            title: '下载',\r\n            isShow: true,\r\n            isPermission: false\r\n          }\r\n        ],\r\n        targetURL: AttachmentURL,\r\n        jsonStr: '',\r\n        bizKey: '',\r\n        title: '',\r\n        visible: false,\r\n        files: [],\r\n        tableHeight: MAX_TABLE_HEIGHT,\r\n        fileAccept: '*' // 上传文件类型\r\n      }\r\n    },\r\n    methods: {\r\n      setFileSize(size) {\r\n        return prettyBytes(size)\r\n      },\r\n      onSubmitClick() {\r\n        console.log('dialog cancel button clicked !')\r\n        if (this.files.length > 0) {\r\n          this._fileUpload(0)\r\n        }\r\n        this.close()\r\n      },\r\n      onCancelClick() {\r\n        this.close()\r\n      },\r\n      close() {\r\n        this.visible = false\r\n        this._afterDialogClose()\r\n      },\r\n      openDialog(_row, _bizKey, _fileAccept) {\r\n        console.log('scheduledictAttachment', 'openDialog')\r\n        this.visible = true\r\n        this.row = _row\r\n        this.bizKey = _bizKey\r\n        this.jsonStr = `{mainId:${_row.id}}`\r\n        this.fileAccept = _fileAccept\r\n      },\r\n      refreshData() {\r\n        this.$refs.pagedTable.getData()\r\n      },\r\n      selectedFile(e) {\r\n        let that = this\r\n        let file = event.target.files[0]\r\n        let formData = new FormData()\r\n        formData.append('file', file)\r\n        this.$http.post('/camel/rest/upload', formData).then(res => {\r\n          if (res.data.success) {\r\n            this._fileUpload({\r\n              mainId: that.row.id,\r\n              attachmentId: res.data.attachmentId,\r\n              attachmentName: res.data.attachmentName,\r\n              attachmentPath: res.data.attachmentPath,\r\n              attachmentRev: res.data.attachmentRev,\r\n              attachmentSize: res.data.attachmentSize,\r\n              attachmentType: res.data.attachmentType\r\n            }, () => {\r\n              this.refreshData()\r\n            })\r\n          }\r\n          // this.$refs.iptFile.value = ''\r\n        })\r\n      },\r\n      customTableTool(row, btnId, tb) {\r\n        switch (btnId) {\r\n          case 'download':\r\n            console.log('row', row.attachmentPath)\r\n            window.open(row.attachmentPath)\r\n            break\r\n        }\r\n      },\r\n      deleteSelectFile(_index, row) {\r\n        this.$confirm('确定要删除吗?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          return this.axios.request({\r\n            method: 'DELETE',\r\n            url: AttachmentURL + '/' + row.id,\r\n            params: {},\r\n            data: {\r\n              id: row.id\r\n            }\r\n          })\r\n        }).then(res => {\r\n          if (res.data.success) {\r\n            this.files = this.files.filter((e, i) => {\r\n              return i !== _index\r\n            })\r\n            Message.success(res.data.msg)\r\n            this.refreshData()\r\n          } else {\r\n            Message.error(res.data.msg)\r\n          }\r\n        }).catch(() => {\r\n        })\r\n      },\r\n      _fileUpload(item, callBack) {\r\n        this.$http.post(AttachmentURL, item).then(res => {\r\n          if (res.data.success) {\r\n            Message.success(res.data.msg)\r\n            if (typeof callBack === 'function') {\r\n              callBack()\r\n            }\r\n          }\r\n        })\r\n      },\r\n      // 查询文件\r\n      _afterDialogClose() {\r\n        EventBus.$emit(this.bizKey + '-' + 'KalixDialogClose')\r\n      }\r\n    },\r\n    computed: {},\r\n    components: {\r\n      PagedTable,\r\n      KalixDateColumn: DateColumn\r\n    }\r\n  }\r\n</script>\r\n<style scoped lang=\"stylus\" type=\"text/stylus\">\r\n  .upload\r\n    display inline-block\r\n    position relative\r\n    overflow hidden\r\n    float left\r\n    input\r\n      position absolute\r\n      top 0\r\n      right -1px\r\n      font-size 100px\r\n      cursor pointer\r\n      opacity 0\r\n\r\n  .file-list\r\n    .el-button\r\n      vertical-align top\r\n      text-decoration none\r\n    .attachment-name\r\n      white-space nowrap\r\n      overflow hidden\r\n      text-overflow ellipsis\r\n\r\n  .kalix-table-pagination\r\n    margin-top 20px\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/custom/baseAttachmentDialog.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{attrs:{\"visible\":_vm.visible,\"before-close\":_vm.close,\"close-on-click-modal\":false,\"append-to-body\":true}},[_c('span',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_c('i',{staticClass:\"iconfont icon-attachment-column\"}),_vm._v(\"附件管理\")]),_c('div',{staticClass:\"file-list\"},[_c('paged-table',{ref:\"pagedTable\",attrs:{\"targetURL\":_vm.targetURL,\"jsonStr\":_vm.jsonStr,\"btnList\":_vm.btnList,\"customTableTool\":_vm.customTableTool}},[_c('template',{slot:\"tableColumnSlot\"},[_c('el-table-column',{attrs:{\"prop\":\"attachmentName\",\"label\":\"名称\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{staticClass:\"attachment-name\"},[_vm._v(_vm._s(scope.row.attachmentName))])]}}])}),_c('el-table-column',{attrs:{\"label\":\"大小\",\"width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(_vm._s(_vm.setFileSize(scope.row.attachmentSize)))])]}}])}),_c('el-table-column',{attrs:{\"prop\":\"attachmentType\",\"label\":\"类型\",\"width\":\"116\"}}),_c('kalix-date-column',{attrs:{\"prop\":\"creationDate\",\"label\":\"上传日期\"}}),_c('el-table-column',{attrs:{\"width\":\"1\"}})],1)],2)],1),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{staticClass:\"upload\"},[_c('i',{staticClass:\"iconfont icon-upload\"}),_vm._v(\"上 传\"),_c('input',{ref:\"iptFile\",attrs:{\"type\":\"file\",\"accept\":_vm.fileAccept},on:{\"change\":_vm.selectedFile}})]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onCancelClick}},[_vm._v(\"关 闭\")])],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-165e3730\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/custom/baseAttachmentDialog.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-165e3730\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./baseAttachmentDialog.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./baseAttachmentDialog.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-165e3730\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./baseAttachmentDialog.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-165e3730\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/custom/baseAttachmentDialog.vue\n// module id = null\n// module chunks = ","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"\\n.upload[data-v-165e3730] {\\n  display: inline-block;\\n  position: relative;\\n  overflow: hidden;\\n  float: left;\\n}\\n.upload input[data-v-165e3730] {\\n  position: absolute;\\n  top: 0;\\n  right: -1px;\\n  font-size: 100px;\\n  cursor: pointer;\\n  opacity: 0;\\n}\\n.file-list .el-button[data-v-165e3730] {\\n  vertical-align: top;\\n  text-decoration: none;\\n}\\n.file-list .attachment-name[data-v-165e3730] {\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n}\\n.kalix-table-pagination[data-v-165e3730] {\\n  margin-top: 20px;\\n}\", \"\", {\"version\":3,\"sources\":[\"D:/vue-develop/project/kalix-vue-project/src/components/custom/baseAttachmentDialog.vue\"],\"names\":[],\"mappings\":\";AACA;EACE,sBAAsB;EACtB,mBAAmB;EACnB,iBAAiB;EACjB,YAAY;CACb;AACD;EACE,mBAAmB;EACnB,OAAO;EACP,YAAY;EACZ,iBAAiB;EACjB,gBAAgB;EAChB,WAAW;CACZ;AACD;EACE,oBAAoB;EACpB,sBAAsB;CACvB;AACD;EACE,oBAAoB;EACpB,iBAAiB;EACjB,wBAAwB;CACzB;AACD;EACE,iBAAiB;CAClB\",\"file\":\"baseAttachmentDialog.vue\",\"sourcesContent\":[\"\\n.upload[data-v-165e3730] {\\n  display: inline-block;\\n  position: relative;\\n  overflow: hidden;\\n  float: left;\\n}\\n.upload input[data-v-165e3730] {\\n  position: absolute;\\n  top: 0;\\n  right: -1px;\\n  font-size: 100px;\\n  cursor: pointer;\\n  opacity: 0;\\n}\\n.file-list .el-button[data-v-165e3730] {\\n  vertical-align: top;\\n  text-decoration: none;\\n}\\n.file-list .attachment-name[data-v-165e3730] {\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n}\\n.kalix-table-pagination[data-v-165e3730] {\\n  margin-top: 20px;\\n}\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-165e3730\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/stylus-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/components/custom/baseAttachmentDialog.vue\n// module id = l/yG\n// module chunks = 1 10","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-165e3730\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/stylus-loader/index.js?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./baseAttachmentDialog.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"73cb56d8\", content, true);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-165e3730\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/stylus-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/components/custom/baseAttachmentDialog.vue\n// module id = qN2j\n// module chunks = 1 10"],"sourceRoot":""}