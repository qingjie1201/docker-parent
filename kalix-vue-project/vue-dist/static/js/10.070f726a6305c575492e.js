webpackJsonp([10],{fK0N:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("u4eY"),i=a("on5L"),o=a("UZBS"),l=a("Cotn"),s=a("rJT4"),c=a("tzRI"),r={data:function(){return{btnList:[{id:"delete",title:"删除",isShow:!0,isPermission:!0},{id:"download",title:"下载",isShow:!0,isPermission:!1}],targetURL:o.AttachmentURL,jsonStr:"",bizKey:"",title:"",visible:!1,files:[],tableHeight:450,fileAccept:"*"}},methods:{setFileSize:function(t){return Object(c.a)(t)},onSubmitClick:function(){console.log("dialog cancel button clicked !"),this.files.length>0&&this._fileUpload(0),this.close()},onCancelClick:function(){this.close()},close:function(){this.visible=!1,this._afterDialogClose()},openDialog:function(t,e,a){console.log("scheduledictAttachment","openDialog"),this.visible=!0,this.row=t,this.bizKey=e,this.jsonStr="{mainId:"+t.id+"}",this.fileAccept=a},refreshData:function(){this.$refs.pagedTable.getData()},selectedFile:function(t){var e=this,a=this,n=event.target.files[0],i=new FormData;i.append("file",n),this.$http.post("/camel/rest/upload",i).then(function(t){t.data.success&&e._fileUpload({mainId:a.row.id,attachmentId:t.data.attachmentId,attachmentName:t.data.attachmentName,attachmentPath:t.data.attachmentPath,attachmentRev:t.data.attachmentRev,attachmentSize:t.data.attachmentSize,attachmentType:t.data.attachmentType},function(){e.refreshData()})})},customTableTool:function(t,e,a){switch(e){case"download":console.log("row",t.attachmentPath),window.open(t.attachmentPath)}},deleteSelectFile:function(t,e){var a=this;this.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return a.axios.request({method:"DELETE",url:o.AttachmentURL+"/"+e.id,params:{},data:{id:e.id}})}).then(function(e){e.data.success?(a.files=a.files.filter(function(e,a){return a!==t}),n.a.success(e.data.msg),a.refreshData()):n.a.error(e.data.msg)}).catch(function(){})},_fileUpload:function(t,e){this.$http.post(o.AttachmentURL,t).then(function(t){t.data.success&&(n.a.success(t.data.msg),"function"==typeof e&&e())})},_afterDialogClose:function(){i.a.$emit(this.bizKey+"-KalixDialogClose")}},computed:{},components:{PagedTable:l.default,KalixDateColumn:s.default}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.visible,"before-close":t.close,"close-on-click-modal":!1,"append-to-body":!0}},[a("span",{attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-attachment-column"}),t._v("附件管理")]),a("div",{staticClass:"file-list"},[a("paged-table",{ref:"pagedTable",attrs:{targetURL:t.targetURL,jsonStr:t.jsonStr,btnList:t.btnList,customTableTool:t.customTableTool}},[a("template",{slot:"tableColumnSlot"},[a("el-table-column",{attrs:{prop:"attachmentName",label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"attachment-name"},[t._v(t._s(e.row.attachmentName))])]}}])}),a("el-table-column",{attrs:{label:"大小",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.setFileSize(e.row.attachmentSize)))])]}}])}),a("el-table-column",{attrs:{prop:"attachmentType",label:"类型",width:"116"}}),a("kalix-date-column",{attrs:{prop:"creationDate",label:"上传日期"}}),a("el-table-column",{attrs:{width:"1"}})],1)],2)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"upload"},[a("i",{staticClass:"iconfont icon-upload"}),t._v("上 传"),a("input",{ref:"iptFile",attrs:{type:"file",accept:t.fileAccept},on:{change:t.selectedFile}})]),a("el-button",{attrs:{type:"primary"},on:{click:t.onCancelClick}},[t._v("关 闭")])],1)])},staticRenderFns:[]},p=a("VU/8")(r,d,!1,function(t){a("qN2j")},"data-v-165e3730",null);e.default=p.exports},"l/yG":function(t,e,a){(t.exports=a("FZ+f")(!0)).push([t.i,"\n.upload[data-v-165e3730] {\n  display: inline-block;\n  position: relative;\n  overflow: hidden;\n  float: left;\n}\n.upload input[data-v-165e3730] {\n  position: absolute;\n  top: 0;\n  right: -1px;\n  font-size: 100px;\n  cursor: pointer;\n  opacity: 0;\n}\n.file-list .el-button[data-v-165e3730] {\n  vertical-align: top;\n  text-decoration: none;\n}\n.file-list .attachment-name[data-v-165e3730] {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.kalix-table-pagination[data-v-165e3730] {\n  margin-top: 20px;\n}","",{version:3,sources:["D:/vue-develop/project/kalix-vue-project/src/components/custom/baseAttachmentDialog.vue"],names:[],mappings:";AACA;EACE,sBAAsB;EACtB,mBAAmB;EACnB,iBAAiB;EACjB,YAAY;CACb;AACD;EACE,mBAAmB;EACnB,OAAO;EACP,YAAY;EACZ,iBAAiB;EACjB,gBAAgB;EAChB,WAAW;CACZ;AACD;EACE,oBAAoB;EACpB,sBAAsB;CACvB;AACD;EACE,oBAAoB;EACpB,iBAAiB;EACjB,wBAAwB;CACzB;AACD;EACE,iBAAiB;CAClB",file:"baseAttachmentDialog.vue",sourcesContent:["\n.upload[data-v-165e3730] {\n  display: inline-block;\n  position: relative;\n  overflow: hidden;\n  float: left;\n}\n.upload input[data-v-165e3730] {\n  position: absolute;\n  top: 0;\n  right: -1px;\n  font-size: 100px;\n  cursor: pointer;\n  opacity: 0;\n}\n.file-list .el-button[data-v-165e3730] {\n  vertical-align: top;\n  text-decoration: none;\n}\n.file-list .attachment-name[data-v-165e3730] {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.kalix-table-pagination[data-v-165e3730] {\n  margin-top: 20px;\n}"],sourceRoot:""}])},qN2j:function(t,e,a){var n=a("l/yG");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("73cb56d8",n,!0)}});
//# sourceMappingURL=10.070f726a6305c575492e.js.map