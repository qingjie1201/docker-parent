webpackJsonp([279],{Vgvp:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("woOf"),a=i.n(s),r=i("u4eY"),o=i("PZKL"),d=i("u8p6"),l=i("yVQT"),n=i("on5L"),h={data:function(){return{formModel:a()({},o.a),treeDataURL:"/camel/rest/roles",treeData:[],defaultProps:{children:"children",label:"name"},checkedKeys:[],ids:[],funIds:[],targetURL:d.rolesURL,contentMessage:""}},components:{KalixDialog:l.default},mounted:function(){},watch:{formModel:{handler:"watchFormModel"}},methods:{getData:function(){var e=this;if(this.treeData=[],this.checkedKeys=[],this.treeDataURL&&this.formModel.id){var t=this.treeDataURL+"/"+this.formModel.id+"/authorizations";this.axios.request({method:"GET",url:t,params:{}}).then(function(t){t.data.children&&(e.treeData=t.data.children,e.getCheckedKeys(e.treeData))})}},getCheckedKeys:function(e){if(e&&e.length>0)for(var t=0;t<e.length;t++)e[t].children&&(0===e[t].children.length?e[t].checked&&this.checkedKeys.push(e[t].id):this.getCheckedKeys(e[t].children))},close:function(){this.onCancelClick()},getIds:function(e){if(e&&e.length>0)for(var t=0;t<e.length;t++)e[t].children&&(-1===e[t].parentId&&e[t].checked&&this.funIds.push("app:"+e[t].id),0===e[t].children.length?e[t].checked&&("-1"===e[t].parentId?this.funIds.push("app:"+e[t].id):this.funIds.push("fun:"+e[t].id)):(e[t].checked&&this.funIds.push("fun:"+e[t].id),this.getIds(e[t].children)))},checkChange:function(e,t,i){e.checked=!!t||!!i},watchFormModel:function(e){this.getData(),e.id&&(this.targetURL=this.targetURL+"/"+e.id+"/authorizations"),this.ids.push(e.id)},submitCustom:function(e){var t=this;this.funIds.push("fun:root"),this.getIds(this.treeData),this.ids.push(this.funIds.join(",")),e.$refs.dialogForm.validate(function(i){if(!i)return r.a.error("请检查输入项！"),e.submitComplete(),!1;t.axios.request({method:e.isEdit?"PUT":"POST",url:e.isEdit?t.targetURL+"/"+t.formModel.id:t.targetURL,data:t.ids,params:{}}).then(function(t){t.data.success?(r.a.success(t.data.msg),e.visible=!1,e.$refs.dialogForm.resetFields(),e.submitComplete()):(r.a.error(t.data.msg),e.submitComplete()),n.a.$emit("refreshData"),e._afterDialogClose(),console.log("[kalix] dialog submit button clicked !"),e.visible=!1})}),this.ids=[]}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("kalix-dialog",{ref:"kalixBizDialog",staticClass:"user-add",attrs:{title:"权限分配",bizKey:"role",formModel:e.formModel,targetURL:e.targetURL,submitCustom:e.submitCustom},on:{"update:formModel":function(t){e.formModel=t}}},[i("div",{staticClass:"el-form",staticStyle:{"max-height":"550px","min-height":"550px",overflow:"auto",border:"1px solid #d0d0d0",margin:"-30px 0 -20px"},attrs:{slot:"dialogFormSlot"},slot:"dialogFormSlot"},[i("el-tree",{ref:"baseTree",staticClass:"filter-tree",attrs:{data:e.treeData,props:e.defaultProps,"node-key":"id","highlight-current":"highlight-current","show-checkbox":"show-checkbox","default-checked-keys":e.checkedKeys,"default-expand-all":"default-expand-all","empty-text":"数据加载中!"},on:{"check-change":e.checkChange}})],1)])},staticRenderFns:[]},u=i("VU/8")(h,c,!1,null,null,null);t.default=u.exports}});
//# sourceMappingURL=279.a9ab3a0dba70b0755624.js.map